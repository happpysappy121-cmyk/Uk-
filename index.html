<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <script>
        /* move this config BEFORE the tailwind CDN so the CDN uses it at load-time */
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Manrope', 'sans-serif'],
                        serif: ['Playfair Display', 'serif'],
                    },
                    colors: {
                        'alpine-dark': '#0f2c25', 
                        'alpine-light': '#1a3c33',
                        'gold-accent': '#d4af37', 
                        'paper-bg': '#f8f9fa',
                        'surface': '#ffffff',
                        'eco-green': '#4ade80',
                        'terracotta': '#e07a5f',
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(15, 44, 37, 0.1)',
                        'float': '0 20px 40px -10px rgba(0,0,0,0.15)',
                        'glow': '0 0 20px rgba(212, 175, 55, 0.2)',
                        'ai-glow': '0 0 25px rgba(124, 58, 237, 0.25)',
                    },
                    backgroundImage: {
                        'ai-gradient': 'linear-gradient(135deg, #0f2c25 0%, #2e1065 100%)',
                        'food-gradient': 'linear-gradient(to top, rgba(0,0,0,0.8), transparent)',
                        'snow-gradient': 'linear-gradient(to top, #e0f2f1 0%, #ffffff 100%)',
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.4s ease-out forwards',
                        'slide-up': 'slideUp 0.5s cubic-bezier(0.2, 0.8, 0.2, 1) forwards',
                        'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    },
                    keyframes: {
                        fadeIn: { from: { opacity: 0 }, to: { opacity: 1 } },
                        slideUp: { from: { transform: 'translateY(20px)', opacity: 0 }, to: { transform: 'translateY(0)', opacity: 1 } }
                    }
                }
            }
        }
    </script>

    <!-- Tailwind CSS (deferred) -->
    <script src="https://cdn.tailwindcss.com" defer></script>

    <style>
        :root{
        --bg-start: #fbfdfc;
        --bg-end: #f3f6f5;
        --card: rgba(255,255,255,0.85);
        --glass: rgba(255,255,255,0.6);
        --muted: #6b7280;
        --accent: #0f2c25;
        --gold: #d4af37;
        --radius-lg: 18px;
        --soft-shadow: 0 8px 24px rgba(15,44,37,0.08);
        --elev-shadow: 0 20px 40px rgba(15,44,37,0.09);
        --ios-border: rgba(15,44,37,0.06);
    }

    /* system font stack for iOS-like feel */
    body{
        font-family: -apple-system, "SF Pro Text", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Manrope", sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background: linear-gradient(180deg,var(--bg-start),var(--bg-end));
        color: #1f2937;
        -webkit-tap-highlight-color: transparent;
        padding-bottom: env(safe-area-inset-bottom);
    }

    /* subtle global smoothing for components */
    * { transition-timing-function: cubic-bezier(.2,.8,.2,1); }

    /* header: translucent, slim, frosted */
    header#app-header{
        background: rgba(255,255,255,0.7);
        backdrop-filter: blur(10px);
        border-bottom: 1px solid var(--ios-border);
        box-shadow: 0 6px 18px rgba(12,22,18,0.04);
    }

    /* premium glass panel used for bottom nav */
    .glass-panel{
        background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.55));
        backdrop-filter: blur(14px);
        border-radius: 22px;
        border: 1px solid var(--ios-border);
        box-shadow: var(--soft-shadow);
    }

    /* cards: soft rounded, elevated */
    .bg-white, .rounded-2xl, .rounded-xl {
        background: var(--card);
        border-radius: var(--radius-lg);
    }
    .shadow-sm { box-shadow: var(--soft-shadow); }
    .shadow-2xl { box-shadow: var(--elev-shadow); }

    /* buttons and primary controls */
    button, .nav-item { 
        transition: transform 160ms ease, box-shadow 160ms ease, background-color 160ms ease;
        border-radius: 14px;
    }
    button:active { transform: translateY(1px) scale(.997); }

    /* modal overlays */
    #festival-modal, #ai-modal, #sos-modal {
        align-items: center;
        justify-content: center;
        padding: 18px;
    }
    #festival-modal > div, #ai-modal > div, #sos-modal > div {
        border-radius: 20px;
        box-shadow: var(--elev-shadow);
        overflow: hidden;
    }

    /* district explorer: make slide smoother */
    #district-explorer-modal {
        border-radius: 18px;
        overflow: clip;
        box-shadow: 0 30px 60px rgba(11,22,18,0.12);
    }
    #district-detail-view {
        border-left: 1px solid var(--ios-border);
    }

    /* card imagery: rounded and mask */
    img { border-radius: 12px; object-fit: cover; }

    /* festival months grid */
    #festival-months button, #festival-months .p-2 {
        border-radius: 12px;
        box-shadow: none;
    }

    /* toast: center floating pill like iOS */
    #toast {
        left: 50%;
        transform: translateX(-50%) translateY(-10px);
        top: 18px;
        padding: 12px 18px;
        border-radius: 999px;
        background: rgba(15,44,37,0.95);
        box-shadow: 0 10px 30px rgba(3,10,8,0.25);
    }

    /* detail modal sheet: rounded top and subtle border */
    #detail-modal {
        border-top-left-radius: 24px;
        border-top-right-radius: 24px;
        box-shadow: 0 -20px 40px rgba(10,20,18,0.08);
    }
    #detail-modal .-mt-10 { margin-top: -42px; } /* keeps hero overlap neat */

    /* input-like elements and small pills */
    .rounded-full, .pill {
        border-radius: 999px;
    }

    /* subtle micro-interactions */
    .group-hover\:scale-110:hover { transform: scale(1.03); }
    .transition-transform { transition: transform 280ms cubic-bezier(.2,.9,.2,1); }

    /* accessible reduced motion support */
    @media (prefers-reduced-motion: reduce) {
        * { transition: none !important; animation: none !important; }
    }

    /* make bottom nav buttons circular and floating */
    nav .nav-item { 
        background: transparent;
    }
    nav .active-nav {
        color: var(--accent) !important;
        position: relative;
    }
    nav .active-nav::after{
        content: "";
        position: absolute;
        bottom: 6px;
        left: 50%;
        transform: translateX(-50%);
        width: 36%;
        height: 3px;
        background: linear-gradient(90deg,var(--accent),var(--gold));
        border-radius: 999px;
        box-shadow: 0 6px 20px rgba(12,22,18,0.08);
    }

    /* gentle card borders for iOS feel */
    .border-gray-100 {
        border-color: var(--ios-border) !important;
    }

    /* Premium nav icon styles */
    .nav-icon {
        width: 44px;
        height: 44px;
        display: grid;
        place-items: center;
        border-radius: 12px;
        background: linear-gradient(180deg, rgba(255,255,255,0.6), rgba(255,255,255,0.35));
        box-shadow: 0 6px 18px rgba(3,10,8,0.08), inset 0 1px 0 rgba(255,255,255,0.6);
        border: 1px solid rgba(15,44,37,0.06);
    }
    .nav-icon svg { width:22px;height:22px; }
    .nav-gradient {
        background: linear-gradient(135deg,var(--accent),var(--gold));
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
    }

    /* Profile extras */
    .badge-pill { padding:6px 10px; border-radius:999px; font-weight:700; font-size:12px; display:inline-flex; gap:8px; align-items:center; }
    .ach-card { background: linear-gradient(90deg,#fff 0%, #fbfbfb 100%); border:1px solid rgba(15,44,37,0.04); box-shadow: 0 8px 24px rgba(15,44,37,0.06); }
    .toggle { width:42px; height:24px; background:#e6e6e8; border-radius:999px; position:relative; cursor:pointer; }
    .toggle .dot { position:absolute; width:18px; height:18px; top:3px; left:3px; border-radius:999px; background:white; box-shadow:0 2px 6px rgba(3,10,8,0.15); transition: all 180ms; }
    .toggle.on { background: linear-gradient(90deg,var(--accent),var(--gold)); }
    .toggle.on .dot { left:21px; }
    .trip-item { cursor:pointer; transition: transform 160ms; }
    .trip-item:hover { transform: translateY(-4px); }

    /* add premium slider styles */
      /* Slider track + slide visuals */
      .kv-track { scroll-snap-type: x mandatory; -webkit-overflow-scrolling: touch; }
      .kv-slide { scroll-snap-align: center; min-width: 320px; transform-origin: center; transition: transform 360ms cubic-bezier(.2,.9,.2,1), box-shadow 360ms; }
      .kv-slide .bg-white { transition: transform 280ms, box-shadow 280ms, border-color 280ms; }
      .kv-slide.active .bg-white { transform: translateY(-6px) scale(1.02); box-shadow: 0 22px 48px rgba(15,44,37,0.12); border-color: rgba(15,44,37,0.08); }

      /* navigation controls */
      .kv-nav { position: absolute; top: 50%; transform: translateY(-50%); z-index: 30; width: 40px; height: 40px; display: grid; place-items:center; background: rgba(255,255,255,0.85); border-radius: 10px; box-shadow: 0 6px 18px rgba(3,10,8,0.08); border:1px solid rgba(15,44,37,0.04); cursor:pointer; }
      .kv-prev { left: 8px; }
      .kv-next { right: 8px; }
      .kv-nav:hover { transform: translateY(-50%) scale(1.02); }

      /* dots */
      .kv-dots { display:flex; gap:8px; justify-content:center; padding-top:8px; }
      .kv-dot { width:8px; height:8px; background: rgba(15,44,37,0.12); border-radius:999px; cursor:pointer; transition: all 220ms; }
      .kv-dot.active { width:28px; background: linear-gradient(90deg,var(--accent),var(--gold)); box-shadow: 0 6px 20px rgba(12,22,18,0.06); }

      /* Responsive refinement */
      @media (min-width: 768px) {
        .kv-slide { min-width: 360px; }
      }
      @media (prefers-reduced-motion: reduce) {
        .kv-slide, .kv-track { scroll-behavior: auto; transition: none !important; animation: none !important; }
      }
    </style>

    <style>
        body {
            background-color: #f4f4f5;
            -webkit-tap-highlight-color: transparent;
            scrollbar-width: none;
            font-family: 'Manrope', sans-serif;
        }
        body::-webkit-scrollbar { display: none; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .snap-x-mandatory { scroll-snap-type: x mandatory; }
        .snap-center { scroll-snap-align: center; }
        
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-top: 1px solid rgba(255, 255, 255, 0.5);
        }

        /* Splash Screen */
        #splash-screen { transition: opacity 0.8s ease-in-out, visibility 0.8s; }
        #splash-screen.hidden-splash { opacity: 0; visibility: hidden; }

        /* View Transitions */
        .view-section {
            display: none;
            animation: fadeIn 0.3s ease-out;
        }
        .view-section.active {
            display: block;
        }
    </style>
</head>
<body class="text-gray-800 pb-24 antialiased bg-paper-bg overflow-hidden">

    <!-- PREMIUM SPLASH SCREEN -->
    <div id="splash-screen" class="fixed inset-0 z-[1000] bg-alpine-dark flex flex-col items-center justify-center text-white">
        <div class="absolute inset-0 z-0">
            <img src="https://images.unsplash.com/photo-1544735716-392fe2489ffa?auto=format&fit=crop&w=1920&q=80" alt="Himalayas" onerror="this.src='https://placehold.co/1920x1080/0f2c25/d4af37?text=Devbhoomi+Elite'" class="w-full h-full object-cover opacity-40">
            <div class="absolute inset-0 bg-gradient-to-b from-alpine-dark/80 via-alpine-dark/60 to-alpine-dark"></div>
        </div>
        <div class="relative z-10 text-center p-8 animate-slide-up">
            <div class="w-20 h-20 rounded-full border-2 border-gold-accent/30 flex items-center justify-center mx-auto mb-6 shadow-glow bg-alpine-dark/50 backdrop-blur-md">
                <span class="text-4xl font-serif font-bold text-gold-accent">D</span>
            </div>
            <h1 class="text-4xl font-serif font-bold mb-2 text-white">Devbhoomi Elite</h1>
            <p class="text-sm font-light text-gold-accent tracking-widest uppercase">The Abode of Gods</p>
        </div>
    </div>

    <!-- HEADER -->
    <header class="fixed top-0 inset-x-0 z-40 bg-white/90 backdrop-blur-md transition-shadow duration-300 shadow-sm" id="app-header">
        <div class="max-w-md mx-auto px-5 py-3 flex justify-between items-center">
            <div class="flex items-center gap-3">
                <div class="w-9 h-9 rounded-full bg-alpine-dark text-gold-accent flex items-center justify-center text-base font-serif font-bold shadow-glow">D</div>
                <div>
                    <p class="text-[9px] text-gray-400 font-bold uppercase tracking-wider">Current Location</p>
                    <h1 class="text-base font-bold text-alpine-dark leading-none">Dehradun <span class="text-xs font-normal text-gray-500">(700m)</span></h1>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <div class="flex items-center gap-1 bg-gray-100 px-2 py-1 rounded-full">
                    <i class="fas fa-cloud-sun text-gold-accent text-xs"></i>
                    <span class="text-[10px] font-bold text-gray-600">21°C</span>
                </div>
                <button class="w-9 h-9 rounded-full border border-gray-200 flex items-center justify-center text-gray-600 hover:bg-gray-50 relative">
                    <i class="far fa-bell"></i>
                    <span class="absolute top-2 right-2.5 w-1.5 h-1.5 bg-gold-accent rounded-full"></span>
                </button>
            </div>
        </div>
    </header>

    <!-- ========================================== -->
    <!-- VIEW 1: HOME DASHBOARD                     -->
    <!-- ========================================== -->
    <div id="view-home" class="view-section active max-w-md mx-auto pt-20 space-y-8 pb-10">
        
        <!-- 1. AI RECOMMENDATION SECTION -->
        <div class="px-5 pt-2">
            <div class="bg-ai-gradient rounded-3xl p-5 text-white shadow-ai-glow relative overflow-hidden cursor-pointer group" onclick="triggerAI()">
                <div class="absolute top-0 right-0 p-4 opacity-30"><i class="fas fa-sparkles text-4xl"></i></div>
                <div class="absolute -bottom-10 -left-10 w-32 h-32 bg-purple-500 rounded-full filter blur-[60px] opacity-30"></div>
                
                <div class="relative z-10">
                    <div class="flex items-center gap-2 mb-2">
                        <span class="bg-white/20 backdrop-blur-sm px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider">DevAI Beta</span>
                        <i class="fas fa-bolt text-gold-accent text-xs animate-pulse"></i>
                    </div>
                    <h2 class="text-xl font-serif font-bold mb-1">Plan your yatra with AI</h2>
                    <p class="text-xs text-gray-300 mb-4 max-w-[80%]">Personalized itineraries based on weather, crowds, and spiritual significance.</p>
                    <button class="bg-white text-alpine-dark text-xs font-bold py-2.5 px-4 rounded-xl shadow-lg flex items-center gap-2 group-hover:scale-105 transition-transform">
                        <i class="fas fa-magic text-purple-600"></i> Ask DevAI
                    </button>
                </div>
            </div>
        </div>

        <!-- 2. ALPINE CONDITIONS / YATRA ADVISORY -->
        <div class="px-5">
            <h3 class="text-lg font-bold text-alpine-dark font-serif mb-3">Alpine Conditions</h3>
            <div class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                <div class="grid grid-cols-3 gap-3">
                    <div class="text-center p-2 bg-snow-gradient rounded-xl border border-gray-50">
                        <i class="fas fa-mountain text-xl text-alpine-dark mb-1"></i>
                        <p class="text-xs font-bold text-alpine-dark">Avg. Altitude</p>
                        <span class="text-sm font-bold text-gold-accent">2,800m</span>
                    </div>
                    <div class="text-center p-2 bg-green-50 rounded-xl border border-gray-50">
                        <i class="fas fa-wind text-xl text-green-600 mb-1"></i>
                        <p class="text-xs font-bold text-alpine-dark">Air Quality</p>
                        <span class="text-sm font-bold text-eco-green">Excellent</span>
                    </div>
                    <div class="text-center p-2 bg-red-50 rounded-xl border border-gray-50">
                        <i class="fas fa-traffic-light text-xl text-red-600 mb-1"></i>
                        <p class="text-xs font-bold text-alpine-dark">Crowd Level</p>
                        <span class="text-sm font-bold text-red-600">High</span>
                    </div>
                </div>
                <div class="mt-4 pt-3 border-t border-gray-100">
                    <div class="flex items-center gap-2">
                         <i class="fas fa-exclamation-circle text-terracotta text-sm"></i>
                        <span class="text-[10px] font-bold uppercase tracking-wider text-terracotta">Yatra Advisory</span>
                    </div>
                    <p class="text-xs text-gray-600 mt-1">Char Dham Yatra routes are open. Heavy rain predicted in Chamoli district. Carry rain gear.</p>
                </div>
            </div>
        </div>


        <!-- 3. DISTRICT EXPLORER TEASER -->
        <div class="pl-5">
            <div class="flex justify-between items-center pr-5 mb-3">
                <h3 class="text-lg font-bold text-alpine-dark font-serif">Explore 13 Districts</h3>
                <button onclick="openDistrictExplorer()" class="text-xs font-bold text-gold-accent">View All <i class="fas fa-arrow-right ml-1"></i></button>
            </div>
            
            <div class="flex gap-3 overflow-x-auto no-scrollbar snap-x-mandatory pr-5 pb-1">
                <!-- District Teaser Cards -->
                <button class="district-btn snap-center w-[160px] h-20 shrink-0 relative overflow-hidden rounded-xl shadow-md active:scale-[0.98] transition-transform" onclick="openDistrictFromTeaser('dehradun')">
                    <img src="https://lh3.googleusercontent.com/d/1QDIOnPbaOEOlifROFWSW2xT4sEc3CPK8" onerror="this.src='https://placehold.co/300x150/1a3c33/d4af37?text=DEHRADUN'" class="w-full h-full object-cover opacity-70">
                    <div class="absolute inset-0 bg-alpine-dark/40 flex items-center justify-center">
                        <span class="font-serif font-bold text-lg text-white drop-shadow-lg">Dehradun</span>
                    </div>
                </button>
                <button class="district-btn snap-center w-[160px] h-20 shrink-0 relative overflow-hidden rounded-xl shadow-md active:scale-[0.98] transition-transform" onclick="openDistrictFromTeaser('nainital')">
                    <img src="https://lh3.googleusercontent.com/d/1VcBP6hPUTlxl2EdGhjdpY3vsDKD6royD" onerror="this.src='https://placehold.co/300x150/1a3c33/d4af37?text=NAINITAL'" class="w-full h-full object-cover opacity-70">
                    <div class="absolute inset-0 bg-alpine-dark/40 flex items-center justify-center">
                        <span class="font-serif font-bold text-lg text-white drop-shadow-lg">Nainital</span>
                    </div>
                </button>
                <button class="district-btn snap-center w-[160px] h-20 shrink-0 relative overflow-hidden rounded-xl shadow-md active:scale-[0.98] transition-transform" onclick="openDistrictExplorer()">
                    <div class="absolute inset-0 bg-alpine-light flex items-center justify-center">
                        <span class="font-serif font-bold text-sm text-gold-accent drop-shadow-lg">Open List <i class="fas fa-th-list ml-1"></i></span>
                    </div>
                </button>
            </div>
        </div>

        <!-- 4. KEY DESTINATIONS (REPLACED: interactive premium slider) -->
        <div class="px-5 relative">
            <h3 class="text-lg font-bold text-alpine-dark font-serif mb-4">Must-Visit Destinations</h3>

            <div class="relative">
                <div id="kv-track" class="kv-track pl-5 overflow-x-auto no-scrollbar flex gap-4 pb-4">
                    <!-- Slide A -->
                    <div class="kv-slide snap-center shrink-0">
                        <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex gap-4 items-center cursor-pointer" onclick="openDetail('kedarnath')">
                            <img src="https://lh3.googleusercontent.com/d/1JcoKuRLm7B-f8ykEKDtktPAsBLaAKsef" onerror="this.src='https://placehold.co/150x100/1a3c33/ffffff?text=KEDARNATH'" class="w-20 h-20 object-cover rounded-xl shrink-0">
                            <div class="flex-1">
                                <h4 class="font-bold text-alpine-dark text-base">Kedarnath Temple</h4>
                                <p class="text-xs text-gray-500 mb-2">3,583m • Rudraprayag</p>
                                <div class="flex items-center gap-2">
                                    <span class="text-[10px] font-bold bg-terracotta/10 text-terracotta px-2 py-0.5 rounded-full">Pilgrimage</span>
                                    <span class="text-[10px] font-bold bg-gold-accent/10 text-gold-accent px-2 py-0.5 rounded-full">High Alt</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 mt-3 flex gap-4 items-center cursor-pointer" onclick="openDetail('haridwar')">
                            <img src="https://lh3.googleusercontent.com/d/15dLcwV2Ym5Ov6NRL_BFUALZUox5F6i2d" onerror="this.src='https://placehold.co/150x100/1a3c33/ffffff?text=HARIDWAR'" class="w-20 h-20 object-cover rounded-xl shrink-0">
                            <div class="flex-1">
                                <h4 class="font-bold text-alpine-dark text-base">Har Ki Pauri</h4>
                                <p class="text-xs text-gray-500 mb-2">294m • Haridwar</p>
                                <div class="flex items-center gap-2">
                                    <span class="text-[10px] font-bold bg-blue-50/50 text-blue-600 px-2 py-0.5 rounded-full">Ganga Aarti</span>
                                    <span class="text-[10px] font-bold bg-green-50/50 text-green-600 px-2 py-0.5 rounded-full">City Access</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Slide B -->
                    <div class="kv-slide snap-center shrink-0">
                        <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex gap-4 items-center cursor-pointer" onclick="openDetail('kedarnath')">
                            <img src="https://lh3.googleusercontent.com/d/1qA3Kb9OeNaEexLT7y2UGlQnk3ArBsN05" onerror="this.src='https://placehold.co/150x100/1a3c33/ffffff?text=DHARI+DEVI'" class="w-20 h-20 object-cover rounded-xl shrink-0">
                            <div class="flex-1">
                                <h4 class="font-bold text-alpine-dark text-base">Dhari Devi Temple</h4>
                                <p class="text-xs text-gray-500 mb-2">600m • Rudraprayag</p>
                                <div class="flex items-center gap-2">
                                    <span class="text-[10px] font-bold bg-terracotta/10 text-terracotta px-2 py-0.5 rounded-full">Pilgrimage</span>
                                    <span class="text-[10px] font-bold bg-gold-accent/10 text-gold-accent px-2 py-0.5 rounded-full">Historic</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 mt-3 flex gap-4 items-center cursor-pointer" onclick="openDetail('haridwar')">
                            <img src="https://lh3.googleusercontent.com/d/11i_0ZcYjmm9pDKNDxKL9j0M8Z_6xT7n2" onerror="this.src='https://placehold.co/150x100/1a3c33/ffffff?text=BADRINATH'" class="w-20 h-20 object-cover rounded-xl shrink-0">
                            <div class="flex-1">
                                <h4 class="font-bold text-alpine-dark text-base">Badrinath</h4>
                                <p class="text-xs text-gray-500 mb-2">3133m • Chamoli</p>
                                <div class="flex items-center gap-2">
                                    <span class="text-[10px] font-bold bg-blue-50/50 text-blue-600 px-2 py-0.5 rounded-full">Sacred</span>
                                    <span class="text-[10px] font-bold bg-green-50/50 text-green-600 px-2 py-0.5 rounded-full">Pilgrim</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Slide C -->
                    <div class="kv-slide snap-center shrink-0">
                        <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex gap-4 items-center cursor-pointer" onclick="openDetail('kedarnath')">
                            <img src="https://lh3.googleusercontent.com/d/1aP47Y3QKjFN_oUfXEEuhuc9cJ4pYmKB3" onerror="this.src='https://placehold.co/150x100/1a3c33/ffffff?text=RUDRANATH'" class="w-20 h-20 object-cover rounded-xl shrink-0">
                            <div class="flex-1">
                                <h4 class="font-bold text-alpine-dark text-base">Rudranath</h4>
                                <p class="text-xs text-gray-500 mb-2">3,600m • Chamoli</p>
                                <div class="flex items-center gap-2">
                                    <span class="text-[10px] font-bold bg-terracotta/10 text-terracotta px-2 py-0.5 rounded-full">Pilgrimage</span>
                                    <span class="text-[10px] font-bold bg-gold-accent/10 text-gold-accent px-2 py-0.5 rounded-full">High Alt</span>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white p-4 rounded-2xl shadow-sm border border-gray-100 mt-3 flex gap-4 items-center cursor-pointer" onclick="openDetail('haridwar')">
                            <img src="https://lh3.googleusercontent.com/d/1D2vV11RcXSG7AYBRrvx75CY1miOHWxmC" onerror="this.src='https://placehold.co/150x100/1a3c33/ffffff?text=TRIJUGI'" class="w-20 h-20 object-cover rounded-xl shrink-0">
                            <div class="flex-1">
                                <h4 class="font-bold text-alpine-dark text-base">TrijugiNarayan Temple</h4>
                                <p class="text-xs text-gray-500 mb-2">294m • Rudraprayag</p>
                                <div class="flex items-center gap-2">
                                    <span class="text-[10px] font-bold bg-blue-50/50 text-blue-600 px-2 py-0.5 rounded-full">Historic</span>
                                    <span class="text-[10px] font-bold bg-green-50/50 text-green-600 px-2 py-0.5 rounded-full">Local</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- arrows -->
                <button id="kv-prev" class="kv-nav kv-prev hidden md:grid"><i class="fas fa-chevron-left text-sm text-alpine-dark"></i></button>
                <button id="kv-next" class="kv-nav kv-next hidden md:grid"><i class="fas fa-chevron-right text-sm text-alpine-dark"></i></button>

                <!-- dots -->
                <div id="kv-dots" class="kv-dots mt-2"></div>
            </div>
        </div>

        <!-- 5. TASTE OF HIMALAYAS -->
        <div>
            <div class="px-5 flex justify-between items-center mb-4 mt-8">
                <h3 class="text-lg font-bold text-alpine-dark font-serif">Taste of Himalayas <i class="fas fa-utensils text-xs text-terracotta ml-1"></i></h3>
            </div>
            <div class="pl-5 overflow-x-auto snap-x-mandatory no-scrollbar flex gap-4 pb-4">
                <!-- Food 1 -->
                <div class="w-[160px] h-[200px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="BalMithai.jpeg" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=Bal+Mithai'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                    <div class="absolute inset-0 bg-food-gradient"></div>
                    <div class="absolute bottom-3 left-3 text-white">
                        <p class="text-xs font-bold text-terracotta uppercase mb-1">Sweet</p>
                        <h4 class="font-serif font-bold text-lg leading-none">Bal Mithai</h4>
                    </div>
                </div>
                <!-- Food 2 -->
                <div class="w-[160px] h-[200px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="https://lh3.googleusercontent.com/d/1P9-mfult0P3pPalEAKHWX_WsbabOAQSS" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=Kafuli'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                    <div class="absolute inset-0 bg-food-gradient"></div>
                    <div class="absolute bottom-3 left-3 text-white">
                        <p class="text-xs font-bold text-terracotta uppercase mb-1">Savory</p>
                        <h4 class="font-serif font-bold text-lg leading-none">Kafuli</h4>
                    </div>
                </div> <!-- <-- ADDED missing closing tag -->

                <!-- Food 3 -->
                <div class="w-[160px] h-[200px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="PahadiKhana.jpeg" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=PahadiKhana'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" alt="Pahadi Thali">
                    <div class="absolute inset-0 bg-food-gradient"></div>
                    <div class="absolute bottom-3 left-3 text-white">
                        <p class="text-xs font-bold text-terracotta uppercase mb-1">Thali</p>
                        <h4 class="font-serif font-bold text-lg leading-none">Pahadi Thali</h4>
                    </div>
                </div>
                                <!-- Food 4 -->
                <div class="w-[160px] h-[200px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="PahadiKhana.jpeg" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=PahadiKhana'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" alt="Pahadi Thali">
                    <div class="absolute inset-0 bg-food-gradient"></div>
                    <div class="absolute bottom-3 left-3 text-white">
                        <p class="text-xs font-bold text-terracotta uppercase mb-1">Thali</p>
                        <h4 class="font-serif font-bold text-lg leading-none">Pahadi Thali</h4>
                    </div>
                </div>
                                                <!-- Food  -->
                <div class="w-[160px] h-[200px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="PahadiKhana.jpeg" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=PahadiKhana'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110" alt="Pahadi Thali">
                    <div class="absolute inset-0 bg-food-gradient"></div>
                    <div class="absolute bottom-3 left-3 text-white">
                        <p class="text-xs font-bold text-terracotta uppercase mb-1">Thali</p>
                        <h4 class="font-serif font-bold text-lg leading-none">Pahadi Thali</h4>
                    </div>
                </div>
            </div>
        </div>

        <!-- 6. LOCAL CRAFTS -->
        <div class="px-5">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-bold text-alpine-dark font-serif">Local Crafts <i class="fas fa-paint-brush text-xs text-gold-accent ml-1"></i></h3>
                <button onclick="showToast('Opening craft guide...')" class="text-xs font-bold text-gold-accent">See All</button>
            </div>
            <div class="pl-5 overflow-x-auto snap-x-mandatory no-scrollbar flex gap-4 pb-4">
                <div class="w-[160px] h-[180px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="https://lh3.googleusercontent.com/d/1eXG0xwuL9Y6_kty6Y2_0QvW-4mwU0FBA" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=Woodcraft'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                    <div class="absolute bottom-3 left-3 text-white">
                        <h4 class="font-serif font-bold text-lg leading-none">Wood Carving</h4>
                        <p class="text-xs">Almora & Kasar Devi</p>
                    </div>
                </div>
                <div class="w-[160px] h-[180px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="https://lh3.googleusercontent.com/d/1Myll5Z4eUwsQ6YeLDKXTY5S-ql02heeU" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=Woolens'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                    <div class="absolute bottom-3 left-3 text-white">
                        <h4 class="font-serif font-bold text-lg leading-none">Wool Weaves</h4>
                        <p class="text-xs">Pithoragarh • Champawat</p>
                    </div>
                </div>
                <div class="w-[160px] h-[180px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="https://lh3.googleusercontent.com/d/1UhOcAkKAH5SoA9KIjJWuIE5hyEfrSloJ" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=Candles'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                    <div class="absolute bottom-3 left-3 text-white">
                        <h4 class="font-serif font-bold text-lg leading-none">Wood & Candle Art</h4>
                        <p class="text-xs">Nainital Markets</p>
                    </div>
                </div>
                 <div class="w-[160px] h-[180px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="https://images.unsplash.com/photo-1531297484001-80022131f5a1?auto=format&fit=crop&w=400&q=80" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=Candles'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                    <div class="absolute bottom-3 left-3 text-white">
                        <h4 class="font-serif font-bold text-lg leading-none">Wood & Candle Art</h4>
                        <p class="text-xs">Nainital Markets</p>
                    </div>
                </div>
                 <div class="w-[160px] h-[180px] shrink-0 snap-center rounded-2xl relative overflow-hidden cursor-pointer group">
                    <img src="https://images.unsplash.com/photo-1531297484001-80022131f5a1?auto=format&fit=crop&w=400&q=80" onerror="this.src='https://placehold.co/400x400/1a3c33/d4af37?text=Candles'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">
                    <div class="absolute bottom-3 left-3 text-white">
                        <h4 class="font-serif font-bold text-lg leading-none">Wood & Candle Art</h4>
                        <p class="text-xs">Nainital Markets</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 7. FESTIVALS CALENDAR -->
        <div class="px-5">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-bold text-alpine-dark font-serif">Festivals & Events <i class="fas fa-calendar-check text-xs text-terracotta ml-1"></i></h3>
                <button onclick="openFestivalCalendar()" class="text-xs font-bold text-gold-accent">Full Calendar</button>
            </div>

            <div id="festival-inline" class="bg-white p-4 rounded-2xl border border-gray-100 shadow-sm">
                <p class="text-xs text-gray-500 mb-3">Tap any month to view festival highlights and local itineraries.</p>
                <div id="festival-months" class="grid grid-cols-6 gap-2">
                    <!-- months rendered by JS -->
                </div>
            </div>
        </div>

        <!-- Festival modal (list events for selected month) -->
        <div id="festival-modal" class="fixed inset-0 z-[1200] hidden items-center justify-center p-4 bg-black/50 opacity-0">
            <div class="bg-white w-full max-w-md rounded-2xl overflow-hidden">
                <div class="flex items-center justify-between px-4 py-3 border-b border-gray-100">
                    <h3 id="festival-modal-title" class="text-lg font-bold text-alpine-dark">Month</h3>
                    <button onclick="closeFestivalCalendar()" class="text-alpine-dark p-2"><i class="fas fa-times"></i></button>
                </div>
                <div id="festival-modal-content" class="p-4 space-y-3 max-h-[60vh] overflow-y-auto">
                    <!-- event items injected here -->
                </div>
                <div class="px-4 py-3 border-t border-gray-100">
                    <button onclick="closeFestivalCalendar()" class="w-full py-2 rounded-lg bg-alpine-dark text-white font-bold">Close</button>
                </div>
            </div>
        </div>

        <!-- 8. NATURE TRAILS (SHORT HIKES) -->
        <div class="px-5">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-bold text-alpine-dark font-serif">Nature Trails <i class="fas fa-hiking text-xs text-eco-green ml-1"></i></h3>
                <button onclick="showToast('Loading trails...')" class="text-xs font-bold text-gold-accent">Explore</button>
            </div>
            <div class="pl-5 overflow-x-auto snap-x-mandatory no-scrollbar flex gap-4 pb-6">
                <div class="w-[220px] shrink-0 snap-center rounded-2xl overflow-hidden bg-white shadow-sm border border-gray-100 cursor-pointer" onclick="openDetail('rishikesh')">
                    <img src="" onerror="this.src='https://placehold.co/600x300/1a3c33/d4af37?text=Trail'" class="w-full h-36 object-cover">
                    <div class="p-3">
                        <h4 class="font-bold text-alpine-dark">Kunjapuri Sunrise</h4>
                        <p class="text-xs text-gray-500">Easy • 1.5 km</p>
                    </div>
                </div>
                <div class="w-[220px] shrink-0 snap-center rounded-2xl overflow-hidden bg-white shadow-sm border border-gray-100 cursor-pointer" onclick="openDetail('chopta')">
                    <img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=600&q=80" onerror="this.src='https://placehold.co/600x300/1a3c33/d4af37?text=Trek'" class="w-full h-36 object-cover">
                    <div class="p-3">
                        <h4 class="font-bold text-alpine-dark">Nag Tibba Ridge</h4>
                        <p class="text-xs text-gray-500">Moderate • Weekend</p>
                    </div>
                </div>
                <div class="w-[220px] shrink-0 snap-center rounded-2xl overflow-hidden bg-white shadow-sm border border-gray-100 cursor-pointer" onclick="openDetail('kedarnath')">
                    <img src="https://images.unsplash.com/photo-1500534314209-a25ddb2bd429?auto=format&fit=crop&w=600&q=80" onerror="this.src='https://placehold.co/600x300/1a3c33/d4af37?text=Valley'" class="w-full h-36 object-cover">
                    <div class="p-3">
                        <h4 class="font-bold text-alpine-dark">Sahastradhara Walks</h4>
                        <p class="text-xs text-gray-500">Easy • Family</p>
                    </div>
                </div>
                                <div class="w-[220px] shrink-0 snap-center rounded-2xl overflow-hidden bg-white shadow-sm border border-gray-100 cursor-pointer" onclick="openDetail('chopta')">
                    <img src="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=600&q=80" onerror="this.src='https://placehold.co/600x300/1a3c33/d4af37?text=Trek'" class="w-full h-36 object-cover">
                    <div class="p-3">
                        <h4 class="font-bold text-alpine-dark">Nag Tibba Ridge</h4>
                        <p class="text-xs text-gray-500">Moderate • Weekend</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- VIEWS 2, 3, 4 (Preserved) -->
    <div id="view-map" class="view-section max-w-md mx-auto h-screen bg-white hidden relative">
        <div class="absolute top-24 left-5 right-5 z-10 bg-white/95 backdrop-blur-md rounded-2xl shadow-lg p-1 border border-gray-100 flex">
            <button class="flex-1 py-2.5 rounded-xl text-xs font-bold text-white bg-alpine-dark shadow-sm">Online Map</button>
            <button class="flex-1 py-2.5 rounded-xl text-xs font-bold text-gray-500" onclick="showToast('Available in Offline Mode')">Offline Areas</button>
        </div>
        <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3444.6279593582275!2d78.0322!3d30.3165!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x390929c356c888af%3A0x4c3562c032518799!2sDehradun!5e0!3m2!1sfr!2sin" width="100%" height="100%" style="border:0;" loading="lazy" class="pt-20"></iframe>
    </div>

    <div id="view-profile" class="view-section max-w-md mx-auto pt-24 px-5 hidden min-h-screen bg-paper-bg">
        <div class="text-center mb-8">
            <div class="w-24 h-24 rounded-full border-4 border-white shadow-lg mx-auto mb-3 overflow-hidden">
                <img src="https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?auto=format&fit=crop&w=200&q=80" class="w-full h-full object-cover" onerror="this.src='https://placehold.co/200x200/cccccc/0f2c25?text=JT'">
            </div>
            <h2 class="text-2xl font-serif font-bold text-alpine-dark">John Traveller</h2>
            <p class="text-sm text-gray-500">Explorer Member • Joined 2023</p>
        </div>
        <div class="grid grid-cols-3 gap-3 mb-6">
            <div class="bg-white p-4 rounded-2xl shadow-sm text-center">
                <h3 class="text-2xl font-bold text-gold-accent">12</h3>
                <p class="text-xs text-gray-400 font-bold uppercase">Yatras</p>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-sm text-center">
                <h3 class="text-2xl font-bold text-eco-green"><i class="fas fa-leaf"></i></h3>
                <p class="text-xs text-gray-400 font-bold uppercase">Eco Badge</p>
            </div>
            <div class="bg-white p-4 rounded-2xl shadow-sm text-center">
                <h3 class="text-2xl font-bold text-terracotta">24k</h3>
                <p class="text-xs text-gray-400 font-bold uppercase">Steps Avg</p>
            </div>
        </div>
        <div class="space-y-3">
            <button class="w-full bg-white p-4 rounded-2xl shadow-sm flex justify-between items-center active:bg-gray-50" onclick="showItinerary()">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-alpine-light/10 text-alpine-dark flex items-center justify-center"><i class="fas fa-map-marked-alt"></i></div>
                    <span class="font-bold text-sm text-alpine-dark">My Itinerary</span>
                </div>
                <i class="fas fa-chevron-right text-xs text-gray-300"></i>
            </button>
             <button class="w-full bg-white p-4 rounded-2xl shadow-sm flex justify-between items-center active:bg-gray-50">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 rounded-full bg-alpine-light/10 text-alpine-dark flex items-center justify-center"><i class="fas fa-user-shield"></i></div>
                    <span class="font-bold text-sm text-alpine-dark">Safety Settings</span>
                </div>
                <i class="fas fa-chevron-right text-xs text-gray-300"></i>
            </button>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- VIEW: GUIDES / TREKS / RENTALS (updated)  -->
    <!-- ========================================== -->
    <div id="view-guides" class="view-section max-w-md mx-auto pt-28 px-5 hidden min-h-screen bg-paper-bg">
            <h2 class="text-3xl font-serif font-bold mb-2 text-alpine-dark">Guides, Treks & Rentals</h2>
            <p class="text-sm text-gray-500 mb-6">Connect with local experts, curated treks and transport rentals — now with itinerary tools and verified partners.</p>

            <!-- New: Search & Filters (replaces emergency row) -->
            <div class="flex gap-2 mb-4 items-center">
                <input id="guide-search" oninput="applyGuideFilters()" placeholder="Search guides, treks, rentals..." class="flex-1 p-3 rounded-2xl border border-gray-100 bg-white text-sm" />
                <select id="guide-type-filter" onchange="applyGuideFilters()" class="p-3 rounded-2xl border border-gray-100 bg-white text-sm">
                    <option value="all">All</option>
                    <option value="guides">Guides</option>
                    <option value="treks">Treks</option>
                    <option value="rentals">Rentals</option>
                </select>
            </div>
            <div class="flex gap-2 mb-6 items-center">
                <select id="guide-lang-filter" onchange="applyGuideFilters()" class="p-2 rounded-2xl border border-gray-100 bg-white text-sm">
                    <option value="any">Any language</option>
                    <option value="en">English</option>
                    <option value="hi">Hindi</option>
                    <option value="pa">Pahadi</option>
                </select>
                <select id="guide-specialty-filter" onchange="applyGuideFilters()" class="p-2 rounded-2xl border border-gray-100 bg-white text-sm">
                    <option value="any">All specialties</option>
                    <option value="pilgrimage">Pilgrimage</option>
                    <option value="trekking">Trekking</option>
                    <option value="birding">Birding</option>
                    <option value="heritage">Heritage</option>
                </select>
                <button onclick="toggleAvailFilter()" id="avail-btn" class="px-3 py-2 rounded-2xl bg-white border border-gray-100 text-sm">Only Available</button>
            </div>

            <!-- Tabs -->
            <div class="flex gap-2 mb-4">
                <button id="tab-guides" class="flex-1 py-2 rounded-2xl bg-alpine-dark text-white font-bold" onclick="showGuidesTab()">Guides</button>
                <button id="tab-treks" class="flex-1 py-2 rounded-2xl bg-white text-alpine-dark border border-gray-100 font-bold" onclick="showTreksTab()">Treks</button>
                <button id="tab-rentals" class="flex-1 py-2 rounded-2xl bg-white text-alpine-dark border border-gray-100 font-bold" onclick="showRentalsTab()">Rentals</button>
            </div>

            <!-- Content panes -->
            <div id="guides-pane" class="space-y-4">
                <!-- populated by JS -->
            </div>

            <div id="treks-pane" class="space-y-4 hidden">
                <!-- populated by JS -->
            </div>

            <div id="rentals-pane" class="space-y-4 hidden">
                <!-- populated by JS -->
            </div>

            <div class="mt-6 text-center">
                <button id="btn-refresh-guides" onclick="refreshGuides()" class="px-5 py-3 bg-alpine-dark text-white rounded-2xl font-bold">Refresh</button>
            </div>
        </div>

    <!-- BOTTOM NAV -->
    <nav class="fixed bottom-0 inset-x-0 glass-panel z-50 pb-safe pt-3 shadow-glass">
        <div class="max-w-md mx-auto flex justify-around items-center h-16 px-2">
            <button class="nav-item active-nav text-alpine-dark flex flex-col items-center gap-1.5 p-2 active:scale-95" data-view="home" onclick="switchView('home', this)">
                <i class="fas fa-compass text-xl"></i>
                <span class="text-[9px] font-bold tracking-widest">EXPLORE</span>
            </button>
            <button class="nav-item text-gray-400 flex flex-col items-center gap-1.5 p-2 active:scale-95 hover:text-gray-600" data-view="map" onclick="switchView('map', this)">
                <i class="fas fa-map text-xl"></i>
                <span class="text-[9px] font-bold tracking-widest">MAPS</span>
            </button>
            <button class="relative -top-6 bg-red-600 text-white w-16 h-16 rounded-full shadow-glow flex items-center justify-center text-2xl border-[5px] border-white active:scale-90 animate-pulse-slow" onclick="showSOS()">
                <i class="fas fa-shield-alt"></i>
            </button>
            <button class="nav-item text-gray-400 flex flex-col items-center gap-1.5 p-2 active:scale-95 hover:text-gray-600" data-view="guides" onclick="switchView('guides', this)">
                <i class="fas fa-route text-xl"></i>
                <span class="text-[9px] font-bold tracking-widest">GUIDES</span>
            </button>
            <button class="nav-item text-gray-400 flex flex-col items-center gap-1.5 p-2 active:scale-95 hover:text-gray-600" data-view="profile" onclick="switchView('profile', this)">
                <i class="far fa-user-circle text-xl"></i>
                <span class="text-[9px] font-bold tracking-widest">PROFILE</span>
            </button>
        </div>
    </nav>

    <!-- DISTRICT EXPLORER (preserved) -->
    <div id="district-explorer-modal" class="fixed inset-0 bg-paper-bg z-[100] transform translate-x-full transition-transform duration-500 flex flex-col max-w-md mx-auto">
        <header class="pt-6 pb-3 px-5 flex items-center justify-between shadow-sm bg-white border-b border-gray-100 sticky top-0 z-20">
            <button onclick="closeDistrictExplorer()" class="text-alpine-dark w-8 h-8 flex items-center justify-center"><i class="fas fa-times text-xl"></i></button>
            <h2 class="text-xl font-serif font-bold text-alpine-dark">Uttarakhand Districts (13)</h2>
            <div class="w-8"></div>
        </header>

        <!-- DISTRICT LIST VIEW -->
        <div id="district-list-view" class="flex-1 overflow-y-auto p-5 space-y-4">
            <!-- Dynamic Content -->
        </div>

        <!-- DISTRICT DETAIL VIEW (Slides in from right) -->
        <div id="district-detail-view" class="absolute inset-0 bg-white transform translate-x-full transition-transform duration-300 flex flex-col z-30">
            <div class="relative h-[35vh] shrink-0">
                <img id="d-detail-img" src="" onerror="this.src='https://placehold.co/600x400/1a3c33/d4af37?text=District+Hero'" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
                <button onclick="closeDistrictDetail()" class="absolute top-6 left-5 w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white border border-white/20"><i class="fas fa-arrow-left"></i></button>
                <div class="absolute bottom-4 left-5 right-5">
                     <h2 id="d-detail-name" class="text-3xl font-serif font-bold text-white drop-shadow-md">District Name</h2>
                     <div class="flex items-center gap-3 mt-1">
                        <span id="d-detail-pop" class="text-[10px] font-bold bg-white/20 backdrop-blur-md text-white px-2 py-0.5 rounded-full border border-white/10">-- Pop.</span>
                        <span id="d-detail-alt" class="text-[10px] font-bold bg-white/20 backdrop-blur-md text-white px-2 py-0.5 rounded-full border border-white/10">-- Alt</span>
                     </div>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto p-6 space-y-6 pb-24">
                <p id="d-detail-desc" class="text-sm text-gray-600 leading-relaxed font-medium"></p>

                <!-- Quick Stats Row -->
                <div class="flex gap-3">
                     <div class="flex-1 bg-gray-50 p-3 rounded-xl border border-gray-100 text-center">
                        <p class="text-xs text-gray-400">Avg Temp</p>
                        <p id="d-detail-temp" class="font-bold text-alpine-dark">--</p>
                     </div>
                     <div class="flex-1 bg-gray-50 p-3 rounded-xl border border-gray-100 text-center">
                        <p class="text-xs text-gray-400">Rainfall</p>
                        <p class="font-bold text-alpine-dark">Moderate</p>
                     </div>
                </div>

                <!-- New Section: Cultural Insights -->
                <div>
                    <h3 class="font-bold text-alpine-dark text-lg mb-3 flex items-center gap-2"><i class="fas fa-music text-terracotta"></i> Cultural Vibe</h3>
                    <div class="p-4 bg-orange-50 rounded-2xl border border-orange-100">
                        <p id="d-detail-culture" class="text-xs text-gray-700 leading-relaxed">--</p>
                    </div>
                </div>

                <!-- New Section: Logistics/Bookings -->
                <div>
                    <h3 class="font-bold text-alpine-dark text-lg mb-3 flex items-center gap-2"><i class="fas fa-plane-departure text-alpine-light"></i> Logistics Hub</h3>
                    <div class="p-4 bg-blue-50 rounded-2xl border border-blue-100">
                        <p id="d-detail-logistics" class="text-xs text-gray-700 leading-relaxed">--</p>
                        <button class="mt-3 w-full py-2 bg-white border border-blue-200 text-blue-700 font-bold text-xs rounded-lg shadow-sm" onclick="showToast('Searching transport options...')">Check Availability</button>
                    </div>
                </div>

                <!-- Primary Attraction -->
                <div>
                    <h3 class="font-bold text-alpine-dark text-lg mb-2">Must See</h3>
                    <div class="p-4 bg-alpine-dark/5 rounded-xl border border-alpine-dark/10 flex items-center gap-3">
                        <i class="fas fa-camera text-2xl text-alpine-dark"></i>
                        <div>
                             <span id="d-detail-attr" class="font-bold text-sm text-alpine-dark block">--</span>
                             <span class="text-[10px] text-gray-500">Top rated tourist spot</span>
                        </div>
                    </div>
                </div>

                <!-- Did You Know -->
                <div class="p-4 bg-yellow-50 rounded-xl border border-yellow-100 flex gap-3">
                    <i class="fas fa-lightbulb text-gold-accent text-xl shrink-0 mt-1"></i>
                    <div>
                        <h4 class="font-bold text-xs text-gold-accent uppercase mb-1">Did You Know?</h4>
                        <p id="d-detail-fact" class="text-xs text-gray-600 italic">--</p>
                    </div>
                </div>

                <!-- Travel Advisory -->
                <div class="p-4 bg-red-50 rounded-xl border border-red-100">
                    <h3 class="font-bold text-red-600 text-xs uppercase mb-1"><i class="fas fa-exclamation-triangle mr-1"></i> Advisory</h3>
                    <p id="d-detail-advice" class="text-xs text-gray-700 leading-relaxed"></p>
                </div>

            </div>
        </div>
    </div>

    <!-- AI MODAL & SOS MODAL (preserved) -->
    <div id="ai-modal" class="fixed inset-0 z-[2000] bg-black/80 backdrop-blur-sm flex items-center justify-center p-5 hidden opacity-0 transition-opacity duration-300">
        <div class="bg-white w-full max-w-sm rounded-[32px] p-6 text-center relative overflow-hidden">
            <button onclick="closeAI()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600"><i class="fas fa-times text-xl"></i></button>
            <div id="ai-thinking" class="py-10">
                <div class="w-16 h-16 mx-auto bg-purple-100 rounded-full flex items-center justify-center text-purple-600 text-2xl mb-4 animate-pulse"><i class="fas fa-brain"></i></div>
                <h3 class="text-xl font-bold text-alpine-dark mb-2">DevAI is thinking...</h3>
            </div>
             <div id="ai-result" class="hidden text-left">
                <!-- AI result content placeholder -->
            </div>
        </div>
    </div>

    <!-- DETAIL MODAL (preserved) -->
    <div id="detail-modal" class="fixed inset-0 bg-white z-[60] transform translate-y-full transition-transform duration-500 flex flex-col">
        <div class="relative h-[45vh] shrink-0">
            <img id="detail-img" src="" class="w-full h-full object-cover">
            <button onclick="closeDetail()" class="absolute top-6 left-5 w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white border border-white/20"><i class="fas fa-arrow-left"></i></button>
        </div>
        <div class="flex-1 bg-white -mt-10 rounded-t-[32px] relative px-6 pt-8 overflow-y-auto pb-24 no-scrollbar z-10">
            <div class="w-12 h-1.5 bg-gray-200 rounded-full mx-auto absolute top-3 left-1/2 -translate-x-1/2"></div>
            <h2 id="detail-title" class="text-3xl font-serif font-bold text-alpine-dark leading-tight mb-1">Location</h2>
            <p class="text-sm text-gray-500 mb-4" id="detail-loc">District</p>
            <div class="grid grid-cols-2 gap-3 mb-6">
                <div class="bg-gray-50 p-4 rounded-xl"><p class="text-xs text-gray-500">Start</p><span class="font-bold text-sm text-alpine-dark" id="detail-start">--</span></div>
                <div class="bg-gray-50 p-4 rounded-xl"><p class="text-xs text-gray-500">Distance</p><span class="font-bold text-sm text-alpine-dark" id="detail-dist">--</span></div>
                <div class="bg-gray-50 p-4 rounded-xl"><p class="text-xs text-gray-500">Elevation</p><span class="font-bold text-sm text-alpine-dark" id="detail-gain">--</span></div>
                <div class="bg-gray-50 p-4 rounded-xl"><p class="text-xs text-gray-500">Duration</p><span class="font-bold text-sm text-alpine-dark" id="detail-days">--</span></div>
            </div>
            <div class="absolute bottom-0 inset-x-0 p-5 bg-white/90 backdrop-blur-md border-t border-gray-100 z-20">
                <button class="w-full py-4 bg-alpine-dark text-white font-bold rounded-2xl shadow-lg" onclick="showToast('Booking Initiated')">Book Guided Tour</button>
            </div>
        </div>
    </div>

    <!-- TOAST -->
    <div id="toast" class="fixed top-6 left-1/2 -translate-x-1/2 bg-alpine-dark/95 backdrop-blur-md text-white px-6 py-3 rounded-full shadow-2xl text-xs font-bold z-[4000] opacity-0 pointer-events-none transition-all duration-300 translate-y-[-20px] flex items-center gap-2">
        <i class="fas fa-info-circle text-gold-accent"></i> <span id="toast-msg">Notification</span>
    </div>

    <script>
        // -- CENTRAL DATASETS (expanded: 10+ items each) --
        const guidesData = [
            { id:'g-01', name:'Arjun Pathak', town:'Dehradun', price:'₹1,200', about:'Sunrise Nag Tibba guide; carries first-aid and hot tea.', rating:4.9, reviews:312, langs:['en','hi'], available:true, verified:true, specialties:['trekking','sunrise'], exp:8, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Arjun' },
            { id:'g-02', name:'Meera Joshi', town:'Rishikesh', price:'₹1,100', about:'Yoga & heritage guide for riverfront walks and aarti timings.', rating:4.8, reviews:201, langs:['en','hi'], available:true, verified:true, specialties:['heritage','wellness'], exp:6, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Meera' },
            { id:'g-03', name:'Pawan Rawat', town:'Kedarnath', price:'₹1,800', about:'Experienced pithari and high-altitude porter coordination.', rating:4.7, reviews:144, langs:['hi','pa'], available:false, verified:false, specialties:['pilgrimage','logistics'], exp:12, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Pawan' },
            { id:'g-04', name:'Nisha Pandey', town:'Nainital', price:'₹900', about:'Heritage walks, local crafts and food trails', rating:4.6, reviews:98, langs:['en','hi'], available:true, verified:true, specialties:['heritage','food'], exp:5, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Nisha' },
            { id:'g-05', name:'Rakesh Thapa', town:'Almora', price:'₹1,300', about:'Mountain naturalist; birding & flora expert.', rating:4.9, reviews:210, langs:['en','pa'], available:true, verified:true, specialties:['birding','nature'], exp:10, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Rakesh' },
            { id:'g-06', name:'Sunita Rawal', town:'Pithoragarh', price:'₹1,600', about:'High altitude trekking specialist; interacts in local dialects.', rating:4.8, reviews:176, langs:['hi','pa'], available:true, verified:false, specialties:['trekking','culture'], exp:9, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Sunita' },
            { id:'g-07', name:'Vikram Negi', town:'Chamoli', price:'₹2,000', about:'Guides Hemkund & Valley of Flowers treks; ensures eco protocols.', rating:4.9, reviews:278, langs:['en','hi'], available:true, verified:true, specialties:['trekking','eco'], exp:14, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Vikram' },
            { id:'g-08', name:'Geeta Rawat', town:'Haridwar', price:'₹800', about:'Pilgrimage coordinator — local transport & ghat timings.', rating:4.5, reviews:87, langs:['hi'], available:true, verified:false, specialties:['pilgrimage','logistics'], exp:4, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Geeta' },
            { id:'g-09', name:'Kumar Singh', town:'Tehri', price:'₹1,400', about:'Water-sports certified guide for Tehri lake activities.', rating:4.6, reviews:123, langs:['en','hi'], available:true, verified:true, specialties:['water-sports','adventure'], exp:7, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Kumar' },
            { id:'g-10', name:'Anjali Bisht', town:'Uttarkashi', price:'₹1,900', about:'Mountaineering assistant; NIM-affiliated trainer.', rating:4.95, reviews:410, langs:['en','hi'], available:false, verified:true, specialties:['mountaineering','training'], exp:16, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Anjali' },
            { id:'g-11', name:'Rohan Chauhan', town:'Bageshwar', price:'₹1,000', about:'Local valleys guide; affordable group discounts.', rating:4.4, reviews:62, langs:['hi','pa'], available:true, verified:false, specialties:['trekking','local'], exp:3, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Rohan' },
            { id:'g-12', name:'Tara Rana', town:'Champawat', price:'₹1,100', about:'Cultural & folklore guide with craft workshop access.', rating:4.7, reviews:95, langs:['hi'], available:true, verified:true, specialties:['culture','crafts'], exp:6, pic:'https://placehold.co/200x120/1a3c33/ffffff?text=Tara' }
        ];

        const treksData = [
            { id:'t-01', title:'Nag Tibba', difficulty:'Easy', duration:'1-2 Days', price:'₹2,000/pax', about:'Weekend trek with panoramic views.', rating:4.6, seasons:['Oct','Nov','Mar','Apr'], maxGroup:12, start:'Dehradun', available:true },
            { id:'t-02', title:'Kuari Pass', difficulty:'Moderate', duration:'3-4 Days', price:'₹4,500/pax', about:'Alpine meadows & Himalayan vistas.', rating:4.7, seasons:['Jun','Sep'], maxGroup:8, start:'Joshimath', available:true },
            { id:'t-03', title:'Har Ki Dun', difficulty:'Moderate', duration:'5-6 Days', price:'₹6,000/pax', about:'Valley trek with cultural stays.', rating:4.9, seasons:['May','Oct'], maxGroup:10, start:'Uttarkashi', available:false },
            { id:'t-04', title:'Tungnath - Chandrashila', difficulty:'Moderate', duration:'2 Days', price:'₹3,200/pax', about:'Highest Shiva temple trek with snow views.', rating:4.8, seasons:['Sep','Jun'], maxGroup:10, start:'Chopta', available:true },
            { id:'t-05', title:'Valley of Flowers', difficulty:'Moderate', duration:'3-4 Days', price:'₹5,200/pax', about:'Floral meadows & alpine biodiversity.', rating:4.95, seasons:['Jul','Aug'], maxGroup:6, start:'Joshimath', available:true },
            { id:'t-06', title:'Roopkund', difficulty:'Hard', duration:'8-10 Days', price:'₹12,500/pax', about:'High altitude lake trek; requires experience.', rating:4.7, seasons:['May','Sep'], maxGroup:12, start:'Uttarkashi', available:false },
            { id:'t-07', title:'Pindari Glacier', difficulty:'Moderate', duration:'6-7 Days', price:'₹8,000/pax', about:'Glacier views & high meadows.', rating:4.5, seasons:['May','Oct'], maxGroup:8, start:'Bageshwar', available:true },
            { id:'t-08', title:'Brahmatal', difficulty:'Moderate', duration:'3-4 Days', price:'₹4,800/pax', about:'Snow trek with panoramic sunrise.', rating:4.6, seasons:['Dec','Feb'], maxGroup:10, start:'Rudraprayag', available:true },
            { id:'t-09', title:'Kedarnath Base', difficulty:'Moderate', duration:'2-3 Days', price:'₹5,500/pax', about:'Pilgrimage route; scenic segments.', rating:4.7, seasons:['May','Oct'], maxGroup:15, start:'Sonprayag', available:true },
            { id:'t-10', title:'Kuari Top (Sunrise)', difficulty:'Easy', duration:'1 Day', price:'₹1,500/pax', about:'Short day trek with sunrise viewpoint.', rating:4.4, seasons:['Mar','Nov'], maxGroup:20, start:'Auli', available:true },
            { id:'t-11', title:'Rudranath Circuit', difficulty:'Hard', duration:'5-6 Days', price:'₹9,000/pax', about:'Remote circuit with cultural homestays.', rating:4.8, seasons:['May','Oct'], maxGroup:8, start:'Gopeshwar', available:false },
            { id:'t-12', title:'Hemkund Sahib', difficulty:'Moderate', duration:'2-3 Days', price:'₹6,500/pax', about:'Pilgrimage trek with alpine lakes.', rating:4.9, seasons:['Jun','Sep'], maxGroup:10, start:'Govindghat', available:true }
        ];

        const rentalsData = [
            { id:'r-01', provider:'Dehradun Cabs', type:'Sedan', capacity:4, pricePerDay:'₹1,800', contact:'9876543210', rating:4.4, available:true, verified:true, location:'Dehradun' },
            { id:'r-02', provider:'Himalayan Rentals', type:'SUV', capacity:6, pricePerDay:'₹3,200', contact:'9123456789', rating:4.6, available:true, verified:true, location:'Rishikesh' },
            { id:'r-03', provider:'BikeHire UK', type:'Motorbike', capacity:1, pricePerDay:'₹600', contact:'9012345678', rating:4.2, available:false, verified:false, location:'Nainital' },
            { id:'r-04', provider:'Alpine Vans', type:'Tempo Traveller', capacity:12, pricePerDay:'₹6,500', contact:'9988776655', rating:4.5, available:true, verified:true, location:'Dehradun' },
            { id:'r-05', provider:'Camper Uttarakhand', type:'Camper Van', capacity:4, pricePerDay:'₹8,500', contact:'9001122334', rating:4.7, available:true, verified:false, location:'Tehri' },
            { id:'r-06', provider:'Pahadi Bikes', type:'Scooter', capacity:1, pricePerDay:'₹450', contact:'9012340000', rating:4.1, available:true, verified:false, location:'Almora' },
            { id:'r-07', provider:'Mountain Movers', type:'Innova', capacity:7, pricePerDay:'₹3,800', contact:'9123009876', rating:4.3, available:true, verified:true, location:'Nainital' },
            { id:'r-08', provider:'EcoRides', type:'Electric SUV', capacity:5, pricePerDay:'₹4,200', contact:'9980011223', rating:4.6, available:true, verified:true, location:'Dehradun' },
            { id:'r-09', provider:'Rural Taxis', type:'Sedan', capacity:4, pricePerDay:'₹1,500', contact:'9011102233', rating:4.0, available:false, verified:false, location:'Pithoragarh' },
            { id:'r-10', provider:'Summit Shuttles', type:'Shuttle Bus', capacity:20, pricePerDay:'₹12,000', contact:'9009988776', rating:4.5, available:true, verified:true, location:'Chamoli' },
            { id:'r-11', provider:'Kumaon Riders', type:'Royal Enfield', capacity:1, pricePerDay:'₹850', contact:'9001234500', rating:4.4, available:true, verified:false, location:'Nainital' },
            { id:'r-12', provider:'Valley Vans', type:'Mini Bus', capacity:10, pricePerDay:'₹7,500', contact:'9012345566', rating:4.2, available:true, verified:true, location:'Rudraprayag' }
        ];

        // -- ITINERARY STORAGE (simple local storage) --
        function loadItinerary(){ try { return JSON.parse(localStorage.getItem('db_itinerary_v1')||'[]'); } catch(e){ return []; } }
        function saveItinerary(list){ localStorage.setItem('db_itinerary_v1', JSON.stringify(list||[])); }
        function addToItinerary(type, id){
            const existing = loadItinerary();
            const item = { type, id, addedAt: new Date().toISOString() };
            // avoid duplicates
            if (existing.find(x=>x.type===type && x.id===id)) { showToast('Already in itinerary'); return; }
            existing.unshift(item);
            saveItinerary(existing);
            showToast('Added to itinerary');
        }
        function showItinerary(){
            const list = loadItinerary();
            if (!list.length) return showToast('Itinerary is empty');
            let msg = `${list.length} items in itinerary`;
            showToast(msg);
            // optionally expand into a modal; kept short per request
        }

        // -- UI: toast & view switching --
        function showToast(msg){
            const t = document.getElementById('toast'), m = document.getElementById('toast-msg');
            m.innerText = msg;
            t.classList.remove('opacity-0','pointer-events-none');
            if (t._timeout) clearTimeout(t._timeout);
            t._timeout = setTimeout(()=> t.classList.add('opacity-0','pointer-events-none'), 3000);
        }

        function switchView(id, btn){
            const viewEl = document.getElementById(`view-${id}`);
            if (!viewEl) return;
            document.querySelectorAll('.view-section').forEach(x=>x.classList.remove('active'));
            viewEl.classList.add('active');
            document.querySelectorAll('.nav-item').forEach(x=>{ x.classList.remove('active-nav','text-alpine-dark'); x.classList.add('text-gray-400'); });
            const btnEl = btn || document.querySelector(`.nav-item[data-view="${id}"]`);
            if (btnEl) { btnEl.classList.add('active-nav','text-alpine-dark'); btnEl.classList.remove('text-gray-400'); }
            closeDistrictExplorer();
            if (id === 'guides') { setTimeout(()=> showGuidesTab(), 50); applyGuideFilters(); }
        }

        // -- Filters state --
        let onlyAvailable = false;
        function toggleAvailFilter(){
            onlyAvailable = !onlyAvailable;
            document.getElementById('avail-btn').classList.toggle('bg-alpine-dark', onlyAvailable);
            document.getElementById('avail-btn').classList.toggle('text-white', onlyAvailable);
            applyGuideFilters();
        }

        // -- Filtering and rendering --
        function applyGuideFilters(){
            const q = (document.getElementById('guide-search')?.value||'').toLowerCase().trim();
            const typeFilter = document.getElementById('guide-type-filter')?.value || 'all';
            const lang = document.getElementById('guide-lang-filter')?.value || 'any';
            const specialty = document.getElementById('guide-specialty-filter')?.value || 'any';

            // guides
            let gList = guidesData.filter(g=>{
                if (onlyAvailable && !g.available) return false;
                if (q && !(g.name||'').toLowerCase().includes(q) && !(g.about||'').toLowerCase().includes(q) && !(g.town||'').toLowerCase().includes(q)) return false;
                if (lang !== 'any' && !g.langs.includes(lang)) return false;
                if (specialty !== 'any' && !(g.specialties||[]).includes(specialty)) return false;
                return true;
            });

            // treks
            let tList = treksData.filter(t=>{
                if (onlyAvailable && !t.available) return false;
                if (q && !(t.title||'').toLowerCase().includes(q) && !(t.about||'').toLowerCase().includes(q)) return false;
                return true;
            });

            // rentals
            let rList = rentalsData.filter(r=>{
                if (onlyAvailable && !r.available) return false;
                if (q && !(r.provider||'').toLowerCase().includes(q) && !(r.type||'').toLowerCase().includes(q) && !(r.location||'').toLowerCase().includes(q)) return false;
                return true;
            });

            if (typeFilter === 'guides') { renderGuides(gList); showGuidesTab(); }
            else if (typeFilter === 'treks') { renderTreks(tList); showTreksTab(); }
            else if (typeFilter === 'rentals') { renderRentals(rList); showRentalsTab(); }
            else { renderGuides(gList); renderTreks(tList); renderRentals(rList); }
        }

        function renderGuides(list = guidesData){
            const container = document.getElementById('guides-pane');
            if (!container) return;
            container.innerHTML = '';
            if (!list.length) { container.innerHTML = '<p class="text-sm text-gray-500">No guides match your filters.</p>'; return; }
            list.forEach(g=>{
                const el = document.createElement('div');
                el.className = 'bg-white p-4 rounded-2xl shadow-sm flex gap-4 items-start';
                el.innerHTML = `
                    <img src="${g.pic}" onerror="this.src='https://placehold.co/80x64/cccccc/0f2c25?text=G'" class="w-20 h-16 rounded-lg object-cover shrink-0">
                    <div class="flex-1">
                        <div class="flex items-start justify-between gap-2">
                            <div>
                                <h4 class="font-bold text-alpine-dark">${g.name} ${g.verified ? '<span class="text-[10px] ml-2 inline-block text-white bg-alpine-dark px-2 py-0.5 rounded-full">Verified</span>' : ''}</h4>
                                <div class="text-xs text-gray-500">${g.town} • ${g.exp} yrs exp</div>
                            </div>
                            <div class="text-right">
                                <div class="text-sm font-bold text-alpine-dark">${g.price}</div>
                                <div class="text-xs text-gray-400">${g.available ? 'Available' : 'Unavailable'}</div>
                            </div>
                        </div>
                        <p class="text-xs text-gray-600 mt-2 line-clamp-2">${g.about}</p>
                        <div class="mt-3 flex items-center justify-between">
                            <div class="flex items-center gap-2 text-xs text-gray-500">
                                <span class="badge-pill bg-gray-100 text-alpine-dark">${g.rating} ★</span>
                                <span class="text-xs">${g.reviews} reviews</span>
                                <div class="flex gap-1 ml-2">${(g.langs||[]).map(l=>`<span class="text-[10px] px-2 py-0.5 rounded-full bg-gray-50 text-gray-600">${l.toUpperCase()}</span>`).join('')}</div>
                            </div>
                            <div class="flex gap-2">
                                <button class="px-3 py-1 text-xs bg-alpine-dark text-white rounded-lg" onclick="bookGuide('${g.id}')">Book</button>
                                <button class="px-3 py-1 text-xs border border-gray-200 rounded-lg" onclick="addToItinerary('guide','${g.id}')">Add</button>
                                <button class="px-3 py-1 text-xs border border-gray-200 rounded-lg" onclick="requestQuote('guide','${g.id}')">Quote</button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(el);
            });
        }

        function renderTreks(list = treksData){
            const container = document.getElementById('treks-pane');
            if (!container) return;
            container.innerHTML = '';
            if (!list.length) { container.innerHTML = '<p class="text-sm text-gray-500">No treks match your filters.</p>'; return; }
            list.forEach(t=>{
                const el = document.createElement('div');
                el.className = 'bg-white p-4 rounded-2xl shadow-sm';
                el.innerHTML = `
                    <div class="flex items-start justify-between gap-3">
                        <div>
                            <h4 class="font-bold text-alpine-dark">${t.title}</h4>
                            <div class="text-xs text-gray-500">${t.difficulty} • ${t.duration} • Start: ${t.start}</div>
                            <p class="text-xs mt-2 text-gray-600">${t.about}</p>
                            <div class="mt-2 text-xs text-gray-500">Group up to ${t.maxGroup} • Seasons: ${t.seasons.join(', ')}</div>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-bold text-alpine-dark mb-2">${t.price}</div>
                            <div class="flex flex-col gap-2">
                                <button class="px-3 py-1 text-xs bg-alpine-dark text-white rounded-lg" onclick="bookTrek('${t.id}')">Book Trek</button>
                                <button class="px-3 py-1 text-xs border border-gray-200 rounded-lg" onclick="addToItinerary('trek','${t.id}')">Add</button>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(el);
            });
        }

        function renderRentals(list = rentalsData){
            const container = document.getElementById('rentals-pane');
            if (!container) return;
            container.innerHTML = '';
            if (!list.length) { container.innerHTML = '<p class="text-sm text-gray-500">No rentals match your filters.</p>'; return; }
            list.forEach(r=>{
                const el = document.createElement('div');
                el.className = 'bg-white p-4 rounded-2xl shadow-sm flex items-center justify-between';
                el.innerHTML = `
                    <div>
                        <h4 class="font-bold text-alpine-dark">${r.provider} <span class="text-xs text-gray-500">· ${r.type}</span> ${r.verified?'<span class="text-xs ml-2 px-2 py-0.5 rounded-full bg-eco-green/10 text-eco-green">Verified</span>':''}</h4>
                        <div class="text-xs text-gray-500">Capacity: ${r.capacity} • ${r.location} • ${r.available ? 'Available' : 'Booked'}</div>
                        <div class="text-xs mt-1 text-gray-500">Contact: ${r.contact}</div>
                    </div>
                    <div class="text-right">
                        <div class="text-sm font-bold text-alpine-dark mb-2">${r.pricePerDay}/day</div>
                        <div class="flex flex-col gap-2">
                            <button class="px-3 py-1 text-xs bg-alpine-dark text-white rounded-lg" onclick="bookRental('${r.id}')">Reserve</button>
                            <button class="px-3 py-1 text-xs border border-gray-200 rounded-lg" onclick="addToItinerary('rental','${r.id}')">Add</button>
                        </div>
                    </div>
                `;
                container.appendChild(el);
            });
        }

        // -- Actions (simple flows) --
        function bookGuide(id){
            const g = guidesData.find(x=>x.id===id);
            if (!g) return showToast('Guide not found');
            showToast(`Booking requested for "${g.name}"`);
        }
        function contactGuide(id){
            const g = guidesData.find(x => x.id === id);
            if (!g) return showToast('Guide not found');
            showToast(`Opening chat with ${g.name}`);
        }
        function bookTrek(id){
            const t = treksData.find(x => x.id === id);
            if (!t) return showToast('Trek not found');
            showToast(`Trek booking requested: ${t.title}`);
        }
        function bookRental(id){
            const r = rentalsData.find(x => x.id === id);
            if (!r) return showToast('Rental provider not found');
            showToast(`Rental reserved with ${r.provider} (${r.type})`);
        }

        function requestQuote(type, id){
            showToast('Quote requested — providers will contact you shortly');
            // expand later: send email/push; kept minimal per request
        }

        function refreshGuides(){
            showToast('Refreshing lists');
            applyGuideFilters();
        }

        // -- Tabs visual helpers --
        function setActiveTab(tabId){
            ['tab-guides','tab-treks','tab-rentals'].forEach(id=>{
                const el = document.getElementById(id);
                if (!el) return;
                if (id === tabId) { el.classList.add('bg-alpine-dark'); el.classList.remove('bg-white','text-alpine-dark'); el.classList.add('text-white'); }
                else { el.classList.remove('bg-alpine-dark','text-white'); el.classList.add('bg-white','text-alpine-dark'); }
            });
            document.getElementById('guides-pane').classList.toggle('hidden', tabId !== 'tab-guides');
            document.getElementById('treks-pane').classList.toggle('hidden', tabId !== 'tab-treks');
            document.getElementById('rentals-pane').classList.toggle('hidden', tabId !== 'tab-rentals');
        }
        function showGuidesTab(){ setActiveTab('tab-guides'); renderGuides(); }
        function showTreksTab(){ setActiveTab('tab-treks'); renderTreks(); }
        function showRentalsTab(){ setActiveTab('tab-rentals'); renderRentals(); }

        // -- District explorer, AI and detail modals (preserved) --
        function renderDistrictList(){ /* preserved earlier logic */ }
        function openDistrictExplorer(){ renderDistrictList(); document.getElementById('district-explorer-modal').classList.remove('translate-x-full'); }
        function closeDistrictExplorer(){ document.getElementById('district-explorer-modal').classList.add('translate-x-full'); }

        function triggerAI(){
            const modal = document.getElementById('ai-modal');
            modal.classList.remove('hidden');
            setTimeout(()=> { modal.classList.remove('opacity-0'); }, 10);
            setTimeout(()=> {
                document.getElementById('ai-thinking').classList.add('hidden');
                document.getElementById('ai-result').classList.remove('hidden');
            }, 1200);
        }
        function closeAI(){
            const modal = document.getElementById('ai-modal');
            modal.classList.add('opacity-0');
            setTimeout(()=> { modal.classList.add('hidden'); document.getElementById('ai-thinking').classList.remove('hidden'); document.getElementById('ai-result').classList.add('hidden'); }, 300);
        }

        // -- Detail modal helpers (preserved) --
        const places = {
            'rishikesh': { title: 'Rishikesh', district: 'Dehradun', img: 'https://images.unsplash.com/photo-1567878155218-c5b0580c6972?auto=format&fit=crop&w=600&q=80', start: 'Laxman Jhula', dist: '5 km', gain: '0 m', days: '1 Day' }
            // ... brief placeholder kept ...
        };
        function openDetail(id){
            const p = places[id];
            if (!p) return showToast('Details coming soon');
            document.getElementById('detail-img').src = p.img;
            document.getElementById('detail-title').innerText = p.title;
            document.getElementById('detail-loc').innerText = p.district;
            document.getElementById('detail-start').innerText = p.start;
            document.getElementById('detail-dist').innerText = p.dist;
            document.getElementById('detail-gain').innerText = p.gain;
            document.getElementById('detail-days').innerText = p.days;
            document.getElementById('detail-modal').classList.remove('translate-y-full');
        }
        function closeDetail(){ document.getElementById('detail-modal').classList.add('translate-y-full'); }

        // SOS preserved globally (not part of guides)
        function showSOS(){ const modal = document.getElementById('sos-modal'); if (modal) { modal.classList.remove('hidden'); setTimeout(()=> modal.classList.remove('opacity-0'), 10); } }
        function closeSOS(){ const modal = document.getElementById('sos-modal'); if (modal) { modal.classList.add('opacity-0'); setTimeout(()=> modal.classList.add('hidden'),300); } }

        // initialize
        window.onload = ()=>{
            const homeBtn = document.querySelector('.nav-item[data-view="home"]') || document.querySelector('.nav-item.active-nav');
            switchView('home', homeBtn);
            setTimeout(()=> { document.getElementById('splash-screen').classList.add('hidden-splash'); document.body.style.overflow='auto'; }, 1200);
            // initial rendering for guides view
            applyGuideFilters();
        };
    </script>
</body>
</html>
